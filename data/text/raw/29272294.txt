properties open_access? PLoS One PLoS ONE plos plosone PLoS ONE 1932-6203 Public Library of Science San Francisco, CA USA 29272294 5741239 10.1371/journal.pone.0190097 PONE-D-17-29726 Research Article Computer and Information Sciences Neural Networks Biology and Life Sciences Neuroscience Neural Networks Biology and Life Sciences Neuroscience Brain Mapping Functional Magnetic Resonance Imaging Medicine and Health Sciences Diagnostic Medicine Diagnostic Radiology Magnetic Resonance Imaging Functional Magnetic Resonance Imaging Research and Analysis Methods Imaging Techniques Diagnostic Radiology Magnetic Resonance Imaging Functional Magnetic Resonance Imaging Medicine and Health Sciences Radiology and Imaging Diagnostic Radiology Magnetic Resonance Imaging Functional Magnetic Resonance Imaging Research and Analysis Methods Imaging Techniques Neuroimaging Functional Magnetic Resonance Imaging Biology and Life Sciences Neuroscience Neuroimaging Functional Magnetic Resonance Imaging Research and Analysis Methods Imaging Techniques Neuroimaging Biology and Life Sciences Neuroscience Neuroimaging Biology and Life Sciences Psychology Emotions Social Sciences Psychology Emotions Research and Analysis Methods Research Assessment Research Validity Biology and Life Sciences Anatomy Brain Cingulate Cortex Medicine and Health Sciences Anatomy Brain Cingulate Cortex Biology and Life Sciences Computational Biology Computational Neuroscience Coding Mechanisms Biology and Life Sciences Neuroscience Computational Neuroscience Coding Mechanisms Biology and Life Sciences Neuroscience Cognitive Science Cognitive Psychology Attention Biology and Life Sciences Psychology Cognitive Psychology Attention Social Sciences Psychology Cognitive Psychology Attention Sparse coding reveals greater functional connectivity in female brains during naturalistic emotional experience Sparse coding reveals gender differences Ren Yudan Investigation Methodology Writing – original draft Writing – review & editing 1 2 Lv Jinglei Methodology 2 Guo Lei Writing – review & editing 1 Fang Jun Writing – review & editing 1 http://orcid.org/0000-0003-1530-0172 Guo Christine Cong Supervision Writing – review & editing 2 * 1 
 School of Automation, Northwestern Polytechnical University, Xi’an, Shaanxi, China 2 
 QIMR Berghofer Medical Research Institute, Herston, Queensland, Australia Zeng Weiming Editor Shanghai Maritime University, CHINA Competing Interests:  The authors have declared that no competing interests exist. * E-mail:  christine.cong@gmail.com 22 12 2017 2017 12 12 e0190097 10 8 2017 10 12 2017 © 2017 Ren et al 2017 Ren et al This is an open access article distributed under the terms of the  Creative Commons Attribution License , which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited. Functional neuroimaging is widely used to examine changes in brain function associated with age, gender or neuropsychiatric conditions. FMRI (functional magnetic resonance imaging) studies employ either laboratory-designed tasks that engage the brain with abstracted and repeated stimuli, or resting state paradigms with little behavioral constraint. Recently, novel neuroimaging paradigms using naturalistic stimuli are gaining increasing attraction, as they offer an ecologically-valid condition to approximate brain function in real life. Wider application of naturalistic paradigms in exploring individual differences in brain function, however, awaits further advances in statistical methods for modeling dynamic and complex dataset. Here, we developed a novel data-driven strategy that employs group sparse representation to assess gender differences in brain responses during naturalistic emotional experience. Comparing to independent component analysis (ICA), sparse coding algorithm considers the intrinsic sparsity of neural coding and thus could be more suitable in modeling dynamic whole-brain fMRI signals. An online dictionary learning and sparse coding algorithm was applied to the aggregated fMRI signals from both groups, which was subsequently factorized into a common time series signal dictionary matrix and the associated weight coefficient matrix. Our results demonstrate that group sparse representation can effectively identify gender differences in functional brain network during natural viewing, with improved sensitivity and reliability over ICA-based method. Group sparse representation hence offers a superior data-driven strategy for examining brain function during naturalistic conditions, with great potential for clinical application in neuropsychiatric disorders. The author(s) received no specific funding for this work. Data Availability All relevant data are within the paper and its Supporting Information files. Data Availability All relevant data are within the paper and its Supporting Information files. Introduction Functional neuroimaging techniques, such as functional magnetic resonance imaging (fMRI), are widely used to examine changes in brain function associated with age, gender, and a wide range of neuropsychiatric disorders [ 1 – 3 ]. Most of these studies used task-based paradigms, where participants perform laboratory-designed tasks in the scanner. While these tasks are designed to engage and isolate a particular aspect of brain function such as working memory or visual perception, it is unclear whether and to what extent such paradigms could uncover the complex mental processes in real life. To address such limitation, recent fMRI studies employed naturalistic stimuli, such as movie and music, to examine neural processes under real-life condition [ 4 – 10 ]. Despite the dynamic and complex nature of these naturalistic paradigms, they evoke highly consistent brain responses across individuals, laying down the foundation of using naturalistic paradigms to study real-life cognition [ 4 – 10 ]. While naturalistic fMRI paradigms are increasingly used to map brain function in healthy populations, only a handful of studies have adopted them to the examination of group differences [ 2 , 7 – 9 ]. One challenge is the lack of effective statistical models to decode neural correlates of naturalistic stimuli [ 11 ]. The inputs in naturalistic paradigms are often dynamic and complex, hence difficult to model using traditional hypothesis-driven methods such as general linear model (GLM) [ 12 ]. Data-driven approaches, which do not depend on specifications of the input stimuli, are hence better suited for naturalistic fMRI studies. Progress has been made with inter-subject correlation and independent component analysis (ICA): several studies have demonstrated that neural synchrony, as measured by inter-subject correlation, during natural viewing is reduced in patients with autism and depression [ 8 , 9 ]. However, inter-subject correlation compares neural responses at the group level, offering very limited view on individual brain responses. ICA, on the other hand, could reconstruct the functional networks for individual brain. A recent naturalistic fMRI study has successfully used ICA to capture altered functional brain networks in individual patients with reduced levels of consciousness [ 13 ]. ICA is based on the assumption of independence between each signal source [ 14 ]. Since brain is composed of complex interconnected networks, there is no biological reason for different spatial components to hold independent distributions [ 15 ]. In addition, ICA does not account for the intrinsic sparsity of neural coding [ 14 ]: the brain encodes information with activities of sparse sets of neuronal ensembles while the majority of neurons are silent [ 16 ]. To address this issue, recent studies have decomposed fMRI signals into linear combinations of multiple atoms based on sparse representation of whole-brain fMRI signals [ 17 – 23 ]. Sparse population coding of a set of neurons has been showed to be more effective than ICA in reconstructing brain networks [ 15 ], which is increasingly applied to fMRI data analyses [ 18 , 20 , 24 ]. The basic sparse representation pipeline is to extract the whole-brain fMRI signals of one subject into a big data matrix, which is subsequently decomposed into a dictionary matrix and an associated coefficient matrix by sparse coding algorithm [ 25 ]. Thus, the time series of each dictionary atom corresponds to the functional activities of a brain network, and its associated coefficient vector represents the spatial map of this brain network. However, as there is no correspondence of dictionary atoms across subjects and groups, it is difficult to derive group inference or compare group differences using previous single subject sparse representation. To address this problem, we here adopted a group sparse representation-based computational framework to extract functional networks during natural viewing [ 26 ]. The advantage of our method is that a common signal dictionary can be learned from the aggregated fMRI signals of two groups of subjects and then the coefficient matrices corresponding to each common dictionary can be used to statistically assess group differences. To learn a common signal dictionary for two groups of subjects from group sparse representation, we assumed that all the subjects evoke highly consistent neural temporal responses during natural viewing, as revealed by previous naturalistic fMRI studies [ 6 , 27 , 28 ]. Here, we applied group sparse representation to naturalistic fMRI data acquired from healthy males and females while they watched an emotional movie. We then statistically compared the gender differences of functional activity based on the correspondences established by the common learned dictionary. The effectiveness and the reproducibility of our method were further evaluated against ICA-based method. Our results demonstrated the feasibility and superiority of group sparse representation on elucidating functional networks and group differences in functional brain activity under naturalistic conditions. Materials and methods Overview The overview of our analytical pipeline is shown in  Fig 1 . First, whole-brain fMRI signals of each subject were extracted using a common mask and then stacked into a 2D signal matrix ( Fig 1a ). Signal matrices from all participants were pooled and concatenated in the spatial dimension into a 2D matrix  S  ( Fig 1b ), which was then factorized into one common dictionary matrix  D , and the associated coefficient matrix  A  composed of 2D individual coefficient sub-matrices for each participant, using online dictionary learning and sparse coding method ( Fig 1c ) [ 25 ]. Finally, the derived coefficient matrices were used to assess functional differences between two groups of subjects, and the test-retest reliability of group sparse representation ( Fig 1d ). All variables used in the main text are defined in  S1 Table . 10.1371/journal.pone.0190097.g001 Fig 1 The computational framework of group sparse representation on the whole-brain fMRI signals from two groups of subjects (G F : Female, G M : Male). (a) Extracting whole-brain fMRI data from subjects  x  (subscript represents the label of subject, e.g.,  x ). (b) FMRI data matrices ( S x ) from all the subjects are aggregated ( S ). (c) Coefficient matrix  A  with the same spatial information and group correspondence of  S , which is decomposed into 2 matrices ( A GF ,  A GM ) corresponding to two groups (G F , G M ), and each group is made of sub-matrices corresponding to the sparse representation for each subject. Data acquisition and pre-processing 18 right–handed (10 females, 8males) healthy subjects (ages 27±2.7) participated in the study, who were all recruited from the University of Queensland and compensated for their participation. Every participant signed a written informed consent. The subject recruitment for the first session lasted from April to October in 2014, while the recruitment for second session lasted from July to December in 2014. The study was approved by the ethics committee of the University of Queensland and was conducted according to National Health and Medical Research Council guidelines. The experiments comprised two scanning sessions with an interval of around 3 months. For each session, participants underwent an 8 min resting state fMRI exam with eyes closed, and then freely viewed a 20-min movie  The Butterfly Circus . This is a short, positively valenced movie that depicts the story of a man born without limbs who is encouraged by the showman of a renowned circus to discover his own potential. All participants reported that they had not previously seen the movie. The movie stimulus was presented using the Presentation software (NeuroBehavioral Systems, USA) and displayed via an MRI-compatible monitor located at the rear of the scanner. The soundtrack of the movie was delivered through MRI-compatible audio headphones (Nordic NeuroLab, Norway). After 3 months, 16 (9 females, 7 males) subjects were scanned with the same protocol for test-retest reliability analysis (session B dataset), although 2 subjects could not return for the re-scan. Thus these 2 subjects were excluded from our test-retest reliability analysis. All structural and functional images were scanned in a whole-body 3T Siemens Trio MRI Scanner. The scanning parameters are TR/TE/FA/FOV of 2200ms/30ms/79°/134mm×134mm, resolution of 3mm×3mm×3mm, and dimension of 64×64×44. Functional images were preprocessed using Statistical Parametric Mapping toolbox (SPM12). The preprocessing pipeline included slice timing correction and realigning, co-registration, normalization, motion correction, spatial smoothing with 6mm full width half maximum Gaussian kernel, and band pass filtering (0.0085–0.15 Hz). Nuisance covariates including WM, CSF and Friston-24 motion parameters were then regressed out using the Data Processing Assistant for Resting-state fMRI software (DPARSF) to reduce potential effects of physiological confounds. By computing the intersection of all single brain masks of each participant together, we generated a group-wise common mask to extract whole brain signals. In this way, we ensured that the same voxels are processed for each participant. We also calculated the mean head motion parameter as the mean absolute displacement of each brain volume as compared to the previous volume estimated from the translation parameters in the x (left/right), y (anterior/posterior), and z (superior/inferior) directions (displacement = square root (x 2 +y 2 +z 2 )) of two groups [ 29 ], and found no significant group differences of mean head motion parameter ( P >0.05, Mean±SD: 0.0552 mm±0.0357 for the female group, and 0.0703 mm±0.0292 for the male group). While the whole naturalistic fMRI dataset was 20-minitute, we first segmented the 20-min fMRI dataset into three segments, according to the narrative structure of the movie  The Butterfly Circus  performed by three experts trained in screenwriting and film theory [ 10 ]. We then applied our framework to one segment of fMRI data (7~13min, both sessions) that comprised a complete event, for the efficiency of computation and investigation of the over-completion problem. We finally replicated all analyses on the whole 20-minute dataset for further validation. Based on both results, we investigated the over-completion problem, that is, less observations (n) than predictors (p) [ 25 ]. Since the two datasets yielded similar results, only results based on middle segment of fMRI are presented in the main text, while the results based on whole fMRI datasets are provided in the supplemental materials ( S1 – S4  Figs,  S2  and  S3  Tables). Affective ratings of the movie After participants completed each scanning session, they were asked to rate their experience when watching the movie, including the level of boredom, enjoyment, valence, as well as the audio and video quality of the movie during fMRI acquisition, in the scale between 1 and 5 ( S4 Table ). Note that higher rating of boredom means more boring the participants feel, while higher rating of enjoyment refers to more enjoyable the participants experience. Participants rated the movie as positive and happy (3.7±1.2). For ratings of boredom, where males (2±1.07) tend to rate higher scores than females (1.10±0.32) indicating that females were more engaged than males during movie viewing ( P <0.0217, two-sample t-test;  Table 1 ). We did not detect significant group differences in ratings of enjoyment, valence and audio and video quality between male and female ( P >0.05;  Table 1 ). 10.1371/journal.pone.0190097.t001 Table 1 Affective ratings of the movie and head motion parameter of females and male. gender boredom  * enjoyment valence audio/video quality head motion female 1.10±0.32 4.20±1.23 3.60±1.17 3.90±0.99 0.0552±0.0357 male 2.00±1.07 3.75±0.89 3.62±1.19 4.00±0.76 0.0703±0.0292 * indicates significant differences between females and males;  P <0.0217, two-sample t-test Dictionary learning and sparse representation theory The sparse coding framework is implemented by custom codes in Matlab (MathWorks, MA, USA) and a publicly available software ( http://spams-devel.gforge.inria.fr/ ). In this framework, each signal sample s i  in the data matrix  S  = [s 1 ,s 2 ,…,s n ]∈R t×n  is modeled as the sparse and linear combination of atoms in a learned dictionary  D  = [d 1 ,d 2 ,…,d m ]∈R t×m , i.e., s i  =  D  × a i  and  S  =  D  ×  A , where  A  = [a 1 ,a 2 ,…,a n ]∈R m×n  is the weight coefficient matrix for sparse representation and each column a i  is the corresponding weight vector for s i  [ 30 ]. Training a solution for sparse representation of  S  = [s 1 ,s 2 ,…,s n ]∈R t×n , the empirical cost function is summarized in  Eq (1)  by considering the average loss of representation for n signals. f n ( D ) ≜ 1 n ∑ i = 1 n ℓ ( s i , D ) (1) The loss function is defined in  Eq (2)  with the ℓ 2  norm that yields the minimization of the representation error, and the ℓ 1  norm that constrains the sparsity of a i . Here,  λ  is a regularization parameter to trade off the representation error and sparsity level. ℓ ( s i , D ) ≜ 1 2 ‖ s i − D a i ‖ 2 2 + λ ‖ a i ‖ 1 a i ∈ R m m i n (2) As we mainly focus on the fluctuation shapes of input signals and aim to prevent  D  from becoming arbitrarily large, we constrain columns d 1 ,d 2 ,…,d m  in  D  with  Eq (3) . C ≜ { D ∈ R t × m s . t . ∀ j = 1 , … m , d j T d j ≤ 1 } (3) In summary, the sparse representation problem is summarized as a matrix factorization problem as shown in  Eq (4) . Similar as in  Eq (2) , the Frobenius norm is employed for factorization error minimization, and the ℓ 1  norm of A matrix yields sparsity. The alternative optimization strategy [ 31 ] is usually employed to solve the problem, where the dictionary  D  and coefficient  A  are iteratively optimized, by alternatingly minimizing over one while keeping the other fixed, and the dictionary  D  is initialized randomly, as proposed by [ 31 ]. A method based on this strategy, called online dictionary learning, which could deal with infinite data input [ 25 ], was proposed and the software ( http://spams-devel.gforge.inria.fr/ ) was developed for public use. Comparing with classical dictionary learning methods that access the whole training data at each iteration to optimize the dictionary  D  and coefficient  A , the online dictionary learning improves the efficiency by progressively augmenting the training data [ 25 , 32 ]. In each iteration, the sparse coding and dictionary updating is performed with a subset of the training data based on stochastic optimization. Afterwards, the subset is then augmented with a new training sample, and the optimization is performed again on the new training data with the outcome of the previous iteration as warm restart. The online dictionary learning repeats these iterations until all training data have been adopted, providing an efficient solution with low memory consumption and computational cost as compared to classical dictionary learning methods [ 25 ]. In this paper, we employ this online dictionary learning and sparse coding method for our group sparse representation analysis. 1 2 D ∈ C , A ∈ R m × n min ‖ S − D A ‖ F 2 + λ ‖ A ‖ 1 , 1 (4) Sparse representation of whole-brain fMRI signals S = [ S G F , S G M ] , S G F = [ S F 1 , S F 2 , … , S Fk ] , S G C = [ S M 1 , S M 2 , … , S M l ] (5) Whole-brain fMRI signals of each subject were extracted and stacked into a 2D matrix  S x  ( x  represents the label of participant,  S Fp  or  S Mq ). The fMRI signals of each voxel make up the columns of  S x . Then, all signal matrices from two groups were pooled and concatenated in the spatial dimension into a big 2Dmatrix  S  ( Fig 1 ). Online dictionary learning and sparse coding method was adopted to decompose  S  into a learned dictionary matrix  D  and the coefficient matrix  A  [ 25 ]. Note that  D  is commonly shared by all subjects, and the  A  has the same spatial voxel organization and group correspondence of  S , which permits group statistical analyses and comparison. Thus,  A  can be decomposed into 2 matrices which represent male and female groups, and each group comprises sub-matrices of participant as shown in  Fig 2 , e.g.,  A GF  is composed of  A F1 ,  A F2 … A Fk . Each column of D corresponds to a dictionary atom and its time course, and each row in  A x  ( A Fp  or  A Mq ) represents its coefficient vector that assigns a coefficient to each voxel in the brain and can be mapped back to the brain volume. 10.1371/journal.pone.0190097.g002 Fig 2 The computational framework of group-wise statistical analysis. Coefficient matrix  A  is composed of two groups of subjects ( G F :  k  female subjects,  G M :  l  male subjects). Each row in group T-test represents a component network, which is then mapped backed to brain volume color coding with z-scores and called z-score map ( n F1  = … =  n Fk  =  n M1  = … =  n Ml  =  n x ). Each row of sub-coefficient matrices  A x  ( A Fp  or  A Mq ) representing individual coefficient spatial map of all the subjects are set as input of SPM12 for two-sample t-tests. There are two essential parameters in sparse coding strategy:  λ  that keeps balance between the residual error of sparse representation and the sparsity of spatial regions in each atom, and the number of dictionary atoms  m . Currently, there is no established criteria on determining  λ  and  m . We thus assessed the impact of parameter settings by systematically varying  λ  (0.1, 0.5, 1) and  m  (100, 200, 400). Specifically, we conducted network decomposition, group difference detection and test-retest reliability analyses using different combinations of  λ  and  m . Results in the main text were obtained when  λ  is set as 0.5 and  m  as 200, and results using other parameter settings are presented in the supplementary materials. While our main conclusion is relatively robust to different parameter settings ( S5 – S7  Figs), we found the setting of  λ  as 0.5 and  m  as 200 produces the highest test-retest reliability and highest number of clusters showing significant group difference, suggesting this setting is relatively more robust ( S6 – S8  Figs). Group-wise statistical analysis A = [ A G F , A G M ] , A G F = [ A F 1 , A F 2 , … , A Fk ] , A G C = [ A M 1 , A M 2 , … , A Ml ] (6) Coefficient matrix  A  maintains the spatial information and group correspondence of  S .  A  can be decomposed into 2 matrices corresponding to two groups ( A GF ,  A GM ), and each group is made of sub-matrices corresponding to the sparse representation for each subject ( Fig 2 ). F and M denote female and male, respectively. Each row of this sub-matrix  A x  represents the individual coefficient spatial map of each dictionary atom (subscript  x  represents the label of participant, e.g.,  Fp  represents the  p th subject in the  F emale group), so the A x (i, j) in each sub-matrix represents the reconstruction coefficient of the j th  voxel to the i th  atom in the dictionary ( Fig 2 ). For all the subjects together, we hypothesize that each coefficient is group-wisely null, and the T-test (with T defined as  Eq (7) ) is carried out to test acceptance or rejection of the null hypothesis for each element. The derived T-value is transformed to z-score [ 12 ]. T ( i , j ) = A G ( i , j ) ^ V a r ( A G ( i , j ) ) , A G ( i , j ) = { A F p ( i , j ) : p = 1 , 2 , … k ; A M q ( i , j ) : q = 1 , 2 , … l } A G ( i , j ) ^ = 1 k + l ( ∑ p = 1 k A F p ( i , j ) + ∑ q = 1 l A M q ( i , j ) ) V a r ( A G ( i , j ) ) = 1 k + l ( ∑ p = 1 k ( A F p ( i , j ) − A G ( i , j ) ^ ) 2 + ∑ q = 1 l ( A M q ( i , j ) − A G ( i , j ) ^ ) 2 ) (7) Due to the sparsity of coefficient matrix  A , the t-test result of  A  is also sparse. Each row of t-test result represents the statistically significant contribution to each dictionary atom, and can be mapped back to brain volume. The resultant z-score map hence represents the spatial distribution of the atom commonly shared by two groups ( Fig 2 ). Corresponding coefficient spatial maps were then used to compare differences between the two groups. To test group differences in each dictionary atom, each row of sub-coefficient matrices  A x  ( A Fp  or  A Mq ) are set as input of SPM12 for two-sample t-tests. Search volume is masked by the z-score map from the one-sample t-test corresponding to the same dictionary atom. Both left-tailed and right-tailed two-sample t-tests were performed. Group-difference results were thresholded using a joint probability distribution method to correct for multiple comparisons [ 33 ]. Two levels of thresholding were used, where a threshold of  P <0.005 was set for voxel height, and paired with two different thresholds for cluster extent (FDR-corrected  P <0.005 and FDR-corrected  P <0.05). Independent component analysis To evaluate the performance of group sparse representation method, we compared it to three commonly-used data-driven strategies. First, we used tensor independent component analysis (tensor ICA) implemented in FSL MELODIC toolkit [ 34 ]. Tensor ICA is commonly used for decomposing the data into independent components where stimulus paradigm is consistent among subjects. Specifically, the number of components in our study was experimentally set to 50, or 100 when specified in the text. Dual regression was then used to project tensor ICA components to each subject space, which were then used for group statistical and test-retest reliability analyses. Similar method is employed to conduct group statistical analysis in SPM12. As no significant results were revealed with the stringent threshold used for group sparse representation, we used a lenient threshold where  P <0.01was used for voxel height, and  P <0.01was used for cluster extent. In addition to tensor ICA, we also examined the functional data with spatial concatenation group ICA method, where the input and output is organized in the same way as group sparse representation [ 35 , 36 ]. This ICA method was implemented using the Fast ICA algorithm [ 37 , 38 ]. Specifically, subjects’ data were concatenated in the spatial dimension into a big signal matrix, which was then factorized into a common time series mixing matrix and the independent spatial components matrix. The spatial components matrix had the same spatial organization of input data and was composed of 2D sub-matrices representing the spatial components for each participant, similar to the coefficient matrix derived by our group sparse representation. Here, the number of components was experimentally set to 50, or 100 when specified in the text. Similar method was adopted to generate group z-score maps and conduct group statistical analysis. As no significant results were revealed with the stringent threshold used for group sparse representation, we used a lenient threshold of  P <0.01 for voxel height and  P <0.01 for cluster extent. Finally, we also adopted commonly used temporal concatenation group ICA, as implemented using GIFT Matlab software [ 39 ]. Subject-specific spatial maps were extracted using back-reconstruction for group statistical and test-retest reliability analyses. As no significant results were revealed with the stringent threshold used for group sparse representation, we used a lenient threshold where  P <0.05 was used for voxel height and  P <0.05 was used for cluster extent. Since temporal concatenation group ICA yielded similar results, they were mostly presented in the supplemental materials ( S9  and  S10  Figs,  S5 Table ). Corresponding brain networks derived across methods were identified by matching them to established network template [ 40 ], followed by careful visual inspection. Furthermore, the corresponding clusters showing gender difference detected across methods were defined by matching them to the Brodmann area and automated anatomical labeling (AAL) atlas, followed by careful visual inspection. Test-retest reliability analysis To test the reproducibility of each brain network fMRI measures, we conducted the same group sparse representation, tensor ICA, spatial and temporal concatenation group ICA on fMRI dataset of session B (16 participants viewed the same movie for the second time), and then identified matching z-score maps which share maximum number of overlapping voxels. The matching was also confirmed with careful visual inspection. For each selected matching network, the networks from two scans were first binarized using a threshold of Z>1.65, and then the common brain region shared by two scans was defined as a mask to evaluate the reliability. The reliability was quantified by calculating the intra-class coefficient (ICC) between measures from the two scans [ 41 , 42 ]. A oneway ANOVA was applied to the measures of the two scans across subjects, to derive between-subject mean square error  MS p  and within-subject mean square error  MS e , where the measures here referred to z-score, thus ensuring measures of different subjects comparable. ICC values were defined as  Eq (8) , where  d  is the number of repeated sessions (here  d  = 2). This form of ICC has been widely used in previous test-retest reliability analyses of fMRI data [ 43 , 44 ]. I C C = M S p − M S e M S p + ( d − 1 ) M S e (8) Only the common brain regions shared by both individual spatial maps and mask defined above were included in ICCs calculation. For both group sparse representation and ICA-based methods, we evaluated test-retest reliability at both scan-wise and voxel-wise levels, following previous methods [ 43 ]. Scan-wise level was defined as the average z-score across all voxels within the common mask generating a single ICC for whole network, while the voxel-wise level was defined as the individual voxel’s z-score generating ICCs for all the voxels within mask. The test-retest reliability is classified as excellent (ICC>0.8), good (ICC 0.6–0.79), moderate (ICC 0.4–0.59), fair (ICC 0.2–0.39) or poor (ICC<0.2). Results Functional brain networks identified with group sparse representation We first investigated whether group sparse representation approach could identify functional brain networks of interests during movie viewing. We applied group sparse coding to naturalistic stimuli fMRI data aggregated from 18 healthy subjects. Voxels with significant reference to each dictionary atom were determined using an experimentally determined threshold (Z>1.65, one-sample t-test). Group sparse representation identified several brain networks that have been established previously, including auditory (#72), visual (#19, #143, #37), dorsal attention (#28), default mode (#46), and salience networks (#119) ( Fig 3 ). Some networks identified with sparse representation appeared to be combinations of different networks, such as auditory and supplementary motor networks (#16), default mode and salience networks (#81), default mode and cerebellar networks (#54, #132), salience and executive control networks (#64), auditory and visual networks (#61) ( Fig 3 ). While network patterns identified under different  λ  (0.1, 0.5, 1) and  m  (100, 200, 400) settings are generally similar, the impact of parameter settings can be observed ( S5 Fig ): the coefficient maps appear to be coarse and noisy with small  λ  and dictionary size, and become sparse with large  λ  and dictionary size ( S5 Fig ). Overall, the setting of  λ  as 0.5 and  m  as 200 resulted in the most robust network decomposition. 10.1371/journal.pone.0190097.g003 Fig 3 Representative brain networks (z-score maps) identified by group sparse representation method. Networks identified by both sparse representation and ICA methods are highlighted by rectangle frames (color code shared with  Fig 4 ). With the same threshold of Z>1.65, both tensor ICA and spatial concatenation group ICA identified similar functional brain networks, including auditory (#7/#11), visual (#3, #22/#28, #47), dorsal attention networks (#11/#26), and default mode and salience (#2/#10) ( Fig 4 ). Five networks were detected by all three methods (labeled in the same color in Figs  3  and  4 ). These results validate that group sparse representation can identify meaningful brain networks driven by naturalistic stimuli. In addition, sparse representation method detected artifact components that related to head-motion, white matter, susceptibility-motion, cardiac, and MRI acquisition/reconstruction ( S11 Fig ), similarly to the ICA methods [ 45 , 46 ]. While these networks share spatial patterns with ICA networks in general, they are more circumscribed than the latter, suggesting the sparse representation framework might be more specific and accurate in defining functional networks. We further examined this possibility by comparing 1) the sensitivity in detecting group differences and 2) the test-retest reliability among the three data-driven methods. 10.1371/journal.pone.0190097.g004 Fig 4 The representative brain networks (z-score maps) identified by (a) tensor ICA method, and (b) spatial concatenation group ICA. Networks identified by both sparse representation and ICA methods are highlighted by rectangle frames (color code shared with  Fig 3 ). Gender differences in functional brain networks A question rises up that whether group sparse representation could detect gender differences in brain responses to natural emotional experience. As shown previously, females tend to present greater emotional reactivity [ 2 , 7 , 47 , 48 ]. Hence, we hypothesized that brain responses to the naturalistic emotional stimulus is more robust in female than male participants. To test this hypothesis, we compared the coefficient spatial maps for each dictionary atom between the female and male groups. Remarkably, several network regions were found to show higher coefficients, or stronger functional connectivity, in females than males, whereas no regions were found to be higher in males ( Fig 5a ; two-sample t-tests). Specifically, females display significantly increased functional connectivity in higher order brain centers, including posterior cingulate cortex, precuneus, insula, anterior cingulate cortex, superior medial frontal gyrus, and superior parietal lobule, as well as thalamic nucleus and medial occipital gyrus ( Fig 5a ;  Table 2 , clusters 1–7;  P <0.005 for voxel height and FDR-corrected  P <0.005 for cluster extent). At a less stringent threshold, additional 7 clusters were detected at the precuneus, posterior cingulate cortex, superior temporal gyrus, inferior frontal gyrus, primary and secondary visual cortices and cerebellar Crus I ( Fig 5a ;  Table 2 , clusters 8–14;  P <0.005 for voxel height and FDR-corrected  P <0.05 for cluster extent). Note, with this less stringent threshold or even an uncorrected threshold ( P <0.005 for voxel height and  P <0.005 for cluster extent), we did not detect any clusters showing greater functional connectivity in male than female participants. 10.1371/journal.pone.0190097.g005 Fig 5 Clusters showing gender difference. (a) 14 clusters detected by group sparse representation that show significantly higher activation in females than males: clusters #1–7 ( P <0.005 for voxel height and FDR-corrected  P <0.005 for cluster extent); cluster #8–14 ( P <0.005 for voxel height and FDR-corrected  P <0.05 for cluster extent). Clusters detected by (b) tensor ICA and (c) spatial concatenation group ICA that show significantly higher activation in females than males ( P <0.01 for voxel height and  P <0.01 for cluster extent). Clusters belonging to same brain region identified by all methods are highlighted in colors. 10.1371/journal.pone.0190097.t002 Table 2 Brain regions with greater activation in females than males as detected by group sparse representation (sorted by  p -value in ascending order). The Network Index refers to the index of dictionary atom generated by group sparse representation algorithm (corresponding to the index in  Fig 3 ). Cluster Index (x y z) T-value Broadmann’s area Region Cluster size Network Index 1 (-10–76 34) 6.45 7,31 precuneus, posterior cingulate cortex 245 19 (12–72 30) 4.97 (12–70 14) 4.60 2 (2 46 16) 4.74 9, 10, 32 superior medial frontal lobe, anterior cingulate cortex 245 132 (-10 52 16) 4.58 (-4 36 20) 4.30 3 (-16–20–2) 6.17 medial dorsal nucleus, ventral lateral nucleus 366 132 (-2–14–2) 5.90 (5–20 0) 4.83 4 (0 20 30) 4.77 32,24 anterior cingulate cortex 180 64 (-2 12 40) 4.59 (6 22 14) 4.15 5 (12–50–18) 4.71 cerebellum 185 132 (4–54–14) 4.61 (-6–54–16) 4.42 6 (32–70 40) 4.15 7, 19 superior parietal lobule, medial occipital gyrus 147 143 (28–78 42) 3.95 (38–80 42) 3.18 7 (-26 26–10) 6.07 13 insula 150 64 (-32 8 4) 4.92 (-32 20 0) 4.32 8 (0–54 48) 4.24 7 precuneus 104 46 (2–58 54) 3.83 (-2–50 54) 3.80 9 (26–74–24) 5.13 cerebellum 119 54 (34–86–32) 4.46 (20–80–24) 4.23 10 (-26–80–30) 5.80 cerebellum 140 54 (-12–76–24) 4.27 (-22–66–32) 4.17 11 (46 22 2) 4.93 22, 47 superior temporal gyrus, inferior frontal gyrus 95 64 (54 4 4) 4.07 (50 20–6) 4.02 12 (-58 6–2) 5.25 22 superior temporal gyrus 99 64 (-58–2 0) 3.48 (-50 12–12) 3.11 13 (20–96–4) 5.19 17, 18 Primary visual cortex, secondary visual cortex 81 143 (18–92–14) 4.40 (10–80–18) 3.97 14 (2–56 40) 4.48 7, 31 precuneus, posterior cingulate cortex 105 143 (-4–64 48) 4.23 (4–44 36) 3.31 In contrast, the effect of gender difference was much weaker with tensor ICA and spatial concatenation group ICA networks, where no significant gender difference was detected using either the two FDR-corrected thresholds ( P <0.005 for voxel height and FDR-corrected  P <0.005 or 0.05 for cluster extent), or the one without FDR correction ( P <0.005 for voxel height and  P <0.005 for cluster extent). Only with a more lenient threshold were we able to detect significant clusters– 3 clusters for tensor ICA and 6 clusters for spatial concatenation group ICA—with greater connectivity in female than male participants ( Fig 5b and 5c ,  S6 Table , clusters 1–3,  S7 Table , cluster 1–6;  P <0.01 for voxel height and  P <0.01 for cluster extent). Two of these clusters, precuneus and anterior cingulate cortex, were detected with the group sparse representation results at stringent FDR-corrected thresholds (highlighted with same color in  Fig 5 ). These results suggested that group sparse representation is more effective and sensitive for detecting functional differences in brain networks than the ICA-based method. In addition, we examined whether these results are robust to different parameter settings in sparse representation. We repeated the group statistical comparison analyses with  λ  of 0.1, 0.5, and 1, and dictionary size of 100, 200, and 400. Across all settings, we detected significantly greater functional connectivity in female than male group, and nothing in the opposite contrast ( P <0.005 for voxel height and FDR-corrected  P <0.05 for cluster extent). The comparison with  λ  as 0.5 and m as 200 appeared to be the most sensitive, with the more significantly different regions detected than other settings ( S6 Fig ). Nonetheless, many of the same clusters were detected using different parameters ( S7 Fig ), suggesting the gender difference results were robust to parameter settings in sparse representation. Test-retest reliability Next, we sought to establish the long term test-retest reliability of our method. The same participants underwent the fMRI scan while they viewed the same movie three months later (session B). Group sparse representation, tensor ICA, spatial and temporal concatenation group ICA were used to identify functional brain networks in the repeated scan sessions. To compare the test-retest reliability of these methods, we focused on four networks that can be detected between session A and B by all three methods: visual network, auditory network, dorsal attention network, and default mode-salience network ( Fig 6  and  S8 Fig ). In addition to these four networks, group sparse representation identified one more matching network, the default mode-cerebellar network ( Fig 6a ), while tensor ICA identified the frontoparietal network. 10.1371/journal.pone.0190097.g006 Fig 6 Test-retest reliability of brain networks. (a) Brain maps of the voxel-wise ICCs of matching networks identified by group sparse representation. (b) Average voxel-wise ICCs and (c) scan-wise ICCs of networks detected by all the methods (Sparse representation/tensor ICA/spatial concatenation group ICA/temporal concatenation group ICA: Visual: #143/#3/#28/#30; Auditory: #72/#7/#11/#1; Dorsal attention: #28/#11/#26/#32; Default mode-salience: #81/#2/#10/#11). Error bars signify variance. The reliability was assessed at both voxel-wise and scan-wise levels [ 43 ]. All four methods showed a range of reliability at the voxel level across different networks ( Fig 6 ), with greater variability in tensor ICA networks (larger error bars in  Fig 6b ). On average, voxel-wise ICCs are moderate in the visual network (0.4573, #143; 0.4459, #30) and the default mode-salience network (0.5147, #81; 0.5376, #11) using group sparse representation and temporal concatenation group ICA, but reduced to fair or poor level with tensor ICA (0.3693, #3; 0.3940, #2) and spatial concatenation group ICA (0.3131, #28; 0.0363, #10) ( Fig 6b ). For the auditory network, average voxel-wise ICCs are at the moderate level using all four methods (0.4261, #72; 0.5086, #7; 0.4558, #11; 0.4268, #1) ( Fig 6b ). Average voxel-wise ICCs are fair in the dorsal attention network using group sparse representation (0.3595, #28) and temporal concatenation group ICA (0.3869, #32), and are at moderate level using the other two ICA methods (0.4969, #11 and 0.4794, #26) ( Fig 6b ). To statistically compare the reliability among four methods, we focused on the voxels that are identified by all methods for these matching networks. In two out of four (visual and default mode-salience), voxel-wise ICCs are significantly higher with group sparse representation than tensor ICA and spatial concatenation group methods (paired t-tests, Bonferroni-corrected  P <0.001,  Fig 6b ). Consistent with previous report [ 43 ], scan-wise ICCs are improved over the average voxel-wise ICCs ( Fig 6b and 6c ). Specifically, scan-wise ICCs of the visual and auditory networks using sparse representation are both excellent (0.8786, #143 and 0.8439, #72), and reduced some with tensor ICA (0.6543, #3; 0.7131, #7), spatial (0.6123, #28; 0.8317, #11) and temporal (0.7586, #30; 0.7087, #1) concatenation group ICA ( Fig 6c ). For the dorsal attention network, scan-wise ICCs are all good across all four methods (0.7269, #28; 0.7402, #11; 0.7452, #26; 0.7418, #32) ( Fig 6c ). The reliability of the default mode-salience network also shows much higher values with temporal concatenation group ICA (0.7632, #11) and sparse representation (0.6357, #81) than the two ICA methods (0.3634, #2 and 0.1689, #10). Some additional networks identified by sparse representation also showed excellent scan-wise ICC such as the default mode-cerebellar network (0.8064, #132). To further assess the impact of parameter setting on test-retest reliability, we repeated the reliability analyses using a combination of component numbers and lambda ( m  = 100, 200, 400;  λ  = 0.1, 0.5, 1) for group sparse representation and a high component number for tensor ICA and spatial concatenation group ICA (100) ( S8 Fig ). We chose three functional networks that can be robustly identified under all settings: visual, auditory and dorsal attention network. Averaging across the three networks, the highest reliability was obtained with  m  = 200 and  λ  = 0.5, further supporting the use of these parameters in the main analyses ( S8 Fig ). Similarly, tensor ICA and group ICA were more reliable with 50 as the component number than 100 ( S8 Fig ). Discussion A variety of methods have been developed for functional neuroimaging analysis, such as general linear model (GLM) [ 12 ], seed-based method [ 49 ], principal component analysis (PCA) [ 50 ], singular value decomposition (SVD) [ 51 ], inter-subject correlation (ISC) [ 8 ], and independent component analysis (ICA) [ 40 ]. While GLM is widely used in detecting task-evoked brain activations, ICA is one of the most common methods in characterizing brain network using naturalistic or resting-state fMRI paradigms. Tensor ICA is particularly suitable for naturalistic fMRI paradigms when data are acquired with consistent stimulus presentation [ 9 ]. However, the underlying statistical assumption of ICA is not well supported by neurobiological basis—brain networks are not necessarily independent from each other. Rather, they could recruit inputs from the same cortical region and interact between each other in the service of behaviors [ 15 , 52 – 57 ]. On the other hand, sparse coding algorithm does not constrain dictionary matrix to be uncorrelated or independent, resulting in low level of correlation among atoms [ 18 , 24 ]. In addition, sparse population coding of a set of neurons has been shown to be more effective in detecting brain activity patterns and brain networks [ 15 , 17 , 23 ]. Recently, a Sparse SPM algorithm based on group sparse dictionary learning shows superior performance for characterizing resting state functional network, over seed-based and ICA methods. However, due to generating common group network and different individual temporal dictionaries, this algorithm differs from our framework that assumes common temporal responses across subjects [ 23 ]. Therefore, our group sparse representation framework offers potential advantage in extracting functional brain networks during naturalistic paradigms. Our study presents comprehensive comparisons between group sparse representation-based and three ICA-based methods, based on their performance on network decomposition, group difference detection and test-retest reliability analyses. Our findings suggest that, while all four methods offer comparable test-retest reliability, sparse representation-based method could be more sensitive in identifying functional brain networks during naturalistic paradigms. Our method builds upon previous studies that employed group sparse representation on static task-based fMRI data [ 26 ], and provides one of the first applications of group sparse representation to naturalistic neuroimaging paradigms. Comparing with individual-based sparse representation methods [ 18 , 24 ], group sparse representation method can automatically establish correspondences across individuals and populations, enabling detailed examinations of group differences or brain-behavioral correlations. Our results revealed that this method could identify well-known functional connectivity networks during dynamic naturalistic stimulation. Furthermore, we developed rigorous statistical tests to characterize group differences in functional activity, taking full advantage of the inherent correspondence between individual networks established by group sparse representation. The current study employed group sparse representation to detect gender differences in brain responses during natural emotional experience. This was motivated by previous findings in psychology and cognitive neuroscience that females respond more strongly than males to affective stimuli [ 7 , 47 , 58 – 62 ]. It is well recognized that females responds more strongly than males to affective stimulus, particularly in limbic regions such as the anterior cingulate cortex in response to negative valence [ 60 , 62 ]. Here, we examined the gender differences in emotional experience using a ecologically-valid paradigms [ 9 ]. We found support from behavioral ratings that females were more engaged by this dynamic emotional stimulus than males ( Table 1 ). Furthermore, our study identified several brain regions that showed stronger functional activations in female. Many of these brain regions are known to contribute to affective processing. Several clusters are detected at the anterior insula (cluster #7) and anterior cingulate cortex (cluster #2, 4), which coactive in response to emotional salience [ 63 ]; the anterior insula is particularly postulated as a hub region that integrates intero- and exteroceptive information and generates the subjective experience of emotion [ 64 , 65 ]. In addition, the default mode network, anchored by the precuneus (cluster #1, 8, 14) and posterior cingulate cortex (PCC) (cluster #1, 14), is activated more strongly in females than males, potentially reflecting greater episodic memory retrieval and self reflection associated with emotion and pain [ 66 , 67 ]. The superior temporal gyrus also showed stronger activations in females than males (cluster #11, 12), consistent with its role in processing emotional facial stimuli [ 68 ]. Although the underlying mechanism of these findings requires further investigation, they support greater responses to naturalistic emotional stimuli in females than males. Our study not only demonstrated gender differences in naturalistic emotional experience, but also characterized meaningful functional brain networks. As shown in  Fig 3 , several brain networks identified with group sparse representation are engaged in audio-visual processing, including visual (#19, #143, #37) and auditory networks (#72). In addition, networks well established in the resting state literature are also detected, including the dorsal attention network (#28) associated with attention-demanding activities [ 69 ], salience network (#119) responding for salience detection [ 70 ], and default mode network (#46) [ 71 ]. Interestingly, sparse representation approach also identified brain networks that appear to be combinations of different network regions, such as auditory and supplementary motor networks (#16), default mode and salience networks (#81), default mode and cerebellar networks (#54, #132), salience and executive control networks (#64), auditory and visual networks (#61), which could reflect the interactions between these brain regions during movie viewing. These networks show consistent spatial and temporal patterns across sparse representation and ICA methods (Figs  3 ,  4  and  7 ). We then further assessed the test-retest reliability of these brain networks identified by our method. While participants might be less engaged in viewing the same movie for the second time, we still observed good test-retest reliability for several networks, confirming that the natural viewing condition manifests improved reliability over resting state condition [ 72 ]. On the other hand, we found that the visual, auditory and attention networks show higher scan-wise ICC values than that of default-salience network ( Fig 6 ). The lower reliable brain activities of higher order brain regions might indicate affective experiences might have changed during repeated viewing. Nonetheless, as our main goal of reliability analysis is to compare the performance of our method to other ICA-based methods, the absolute values for reliability is not the focus of this study. In addition, sparse representation method could separate artifact components relating to head-motion, white matter, susceptibility-motion, cardiac, and MRI acquisition/reconstruction ( S11 Fig ) [ 45 , 46 ]. Some of these artifact components might also be influenced by the naturalistic stimuli, such as ones related to the head motion. Overall, our method can effectively and robustly detect meaningful brain networks driven by naturalistic stimuli. 10.1371/journal.pone.0190097.g007 Fig 7 Time courses of representative networks identified by group sparse representation, tensor ICA and spatial concatenation group ICA. Pearson’s correlation between the time courses of group sparse representation and ICA is labeled on the panel of the corresponding ICA method (upper left corner). We further assessed the effect of parameter setting in sparse representation with rigorous statistical analysis ( S6  and  S7  Figs). We found that the gender differences in functional connectivity were very robust to parameter settings—significantly greater functional connectivity in female than male group was identified across all parameter settings ( P <0.005 for voxel height and FDR-corrected  P <0.05 for cluster extent). The setting used for the main analysis,  λ  as 0.5 and  m  as 200, generated the highest number of clusters showing significant gender difference ( S6 Fig ). Network components extracted with this setting also showed the highest test-retest reliability ( S8 Fig ), suggesting the selection of this parameter setting is relatively more robust. Furthermore, our application was not significantly impacted by over-completion, that is, less observations (n) than predictors (p). Here, the observations are time points of fMRI scan, and the predictors refer to the learned dictionary atoms. Sparse representation using either a segment of fMRI data (n<p) or the whole data (n>p) generated very similar results ( S1 – S4  Figs,  S2  and  S3  Tables), suggesting that our results are robust to over-completion. Other studies have also shown that over-completion is a valid setting in Lasso framework and appears to offer several advantages, including greater robustness when facing with noises and other kinds of degradation, superior flexibility in matching the generative model to the structure of input data and better approximation of the underlying statistical distribution [ 25 , 73 – 75 ]. In summary, our study developed a novel application of group sparse representation on naturalistic fMRI data. Using rigorous statistical analyses, we demonstrated that group sparse representation could reliably identify functional networks during natural viewing and detected subtle gender differences in these networks with higher sensitivity than ICA-based method. Hence, the group sparse representation framework could offer a suitable approach in analyzing dynamic fMRI data during naturalistic paradigms. In the future, dimension reduction of input data can be investigated to further improve the effectiveness and efficiency of our framework. In addition, it would be useful to test our framework to naturalistic fMRI datasets acquired during different emotional movies to further validate and investigate gender differences during affective processing. Moreover, this framework could potentially be useful in clinical research, to detect abnormal brain function and develop neuroimaging markers for neuropsychiatric disorders. One potential concern is that if large differences exist between the groups, such as patients and healthy controls, it may be inappropriate to pool fMRI data together for dictionary training. Further investigation is needed to further explore the potential of sparse representation in clinical neuroscience. Supporting information S1 Fig Fifteen clusters detected by group sparse representation for whole fMRI data that show significantly higher activation in females than males. (a) Clusters #1 ( P <0.005 for voxel height and FDR-corrected  P <0.001 for cluster extent) (b) Cluster #2–15 ( P <0.005 for voxel height and FDR-corrected  P <0.05 for cluster extent). Clusters identified by both group sparse representation and tensor ICA are highlighted in color (color code shared with  S2 Fig ). (TIF) Click here for additional data file. S2 Fig Two clusters detected by tensor ICA for whole fMRI data that show significantly higher activation in females than males ( P <0.01 for voxel height and  P <0.01 for cluster extent). Clusters identified by both group sparse representation and tensor ICA are highlighted in colors (color code shared with  S1 Fig ). (TIF) Click here for additional data file. S3 Fig Test-retest reliability of brain networks identified for whole fMRI data. (a) Brain maps of the voxel-wise ICCs of matching networks identified by group sparse representation and tensor ICA for whole fMRI data. (b) scan-wise ICCs and (c) average voxel-wise ICCs of networks detected by both methods. Error bars signify variance. (TIF) Click here for additional data file. S4 Fig Comparison of test-retest reliability results using different parameters (m = 100, 200, 400; λ = 0.1, 0.5, 1) for group sparse representation and different component numbers for tensor ICA (m = 50, 200) (whole fMRI data). (a) Brain maps of the voxel-wise ICCs of matching networks identified by the two methods. (b) Average scan-wise and voxel-wise ICCs (Error bars signify the average variance of each network’s voxel-wise ICC). (TIF) Click here for additional data file. S5 Fig Seven representative functional networks identified using different parameters (m = 100, 200,400; λ = 0.1, 0.5, 1) for group sparse representation. (TIF) Click here for additional data file. S6 Fig Comparison of number of clusters showing significantly greater functional connectivity in female than male group using different parameters (m = 100, 200,400; λ = 0.1, 0.5, 1) for group sparse representation. (TIF) Click here for additional data file. S7 Fig corresponding clusters showing significantly greater functional connectivity in female than male group using different parameters (m = 100, 200, 400; λ = 0.1, 0.5, 1) for group sparse representation (clusters identified under m = 200 and λ = 0.5 share the same indices with  Fig 5  in main text). (TIF) Click here for additional data file. S8 Fig Comparison of test-retest reliability results using different parameters (m = 100, 200, 400; λ = 0.1, 0.5, 1) for group sparse representation, and different component numbers for tensor ICA and spatial concatenation group ICA (m = 50, 100), and temporal concatenation group ICA. (a) Brain maps of the voxel-wise ICCs of matching networks identified by the three methods. (b) Average scan-wise and voxel-wise ICCs (Error bars signify the average variance of each network’s voxel-wise ICC). (TIF) Click here for additional data file. S9 Fig The representative brain networks identified by temporal concatenation group ICA. Networks identified by all methods are highlighted by rectangle frames (color code shared with  Fig 3  in the main text). (TIF) Click here for additional data file. S10 Fig Clusters detected by temporal concatenation group ICA that show significantly higher activation in females than males ( P <0.05 for voxel height and  P <0.05 for cluster extent). Clusters identified by all methods are highlighted in colors (color code shared with  Fig 5  in the main text). (TIF) Click here for additional data file. S11 Fig Artifact related components identified by (a) group sparse representation, (b) tensor ICA, (c) and spatial concatenation group ICA. (TIF) Click here for additional data file. S1 Table The variables and the explanations. (DOCX) Click here for additional data file. S2 Table Brain regions with greater activation in females than males as detected by group sparse representation for whole fMRI data(sorted by  p -value in ascending order). (DOCX) Click here for additional data file. S3 Table Brain regions with greater activation in females than males as detected by tensor ICA for whole fMRI data(sorted by  p -value in ascending order). (DOCX) Click here for additional data file. S4 Table The questionnaire for subjects rating their experience after scanning session. (DOCX) Click here for additional data file. S5 Table Brain areas with greater activation in females than males as detected by temporal concatenation group ICA (sorted by  p -value in ascending order). (DOCX) Click here for additional data file. S6 Table Brain areas with greater activation in females than males as detected by tensor ICA (sorted by  p -value in ascending order). (DOCX) Click here for additional data file. S7 Table Brain regions with greater activation in females than males as detected by spatial concatenation group ICA (sorted by  p -value in ascending order). (DOCX) Click here for additional data file. References 1 Calhoun VD ,  Eichele T ,  Pearlson G  ( 2009 )  Functional brain networks in schizophrenia: a review .  Frontiers in human neuroscience 
 3 :  17 
 doi:  10.3389/neuro.09.017.2009 
 19738925 2 Kret ME ,  De Gelder B  ( 2012 )  A review on sex differences in processing emotional signals .  Neuropsychologia 
 50 :  1211 – 1221 .  doi:  10.1016/j.neuropsychologia.2011.12.022 
 22245006 3 Rajah MN ,  D’Esposito M  ( 2005 )  Region-specific changes in prefrontal function with age: a review of PET and fMRI studies on working and episodic memory .  Brain 
 128 :  1964 – 1983 .  doi:  10.1093/brain/awh608 
 16049041 4 Bartels A ,  Zeki S  ( 2005 )  Brain dynamics during natural viewing conditions—a new guide for mapping connectivity in vivo .  Neuroimage 
 24 :  339 – 349 .  doi:  10.1016/j.neuroimage.2004.08.044 
 15627577 5 Malinen S ,  Hlushchuk Y ,  Hari R  ( 2007 )  Towards natural stimulation in fMRI—issues of data analysis .  Neuroimage 
 35 :  131 – 139 .  doi:  10.1016/j.neuroimage.2006.11.015 
 17208459 6 Hasson U ,  Nir Y ,  Levy I ,  Fuhrmann G ,  Malach R  ( 2004 )  Intersubject synchronization of cortical activity during natural vision .  science 
 303 :  1634 – 1640 .  doi:  10.1126/science.1089506 
 15016991 7 Codispoti M ,  Surcinelli P ,  Baldaro B  ( 2008 )  Watching emotional movies: Affective reactions and gender differences .  International Journal of Psychophysiology 
 69 :  90 – 95 .  doi:  10.1016/j.ijpsycho.2008.03.004 
 18433903 8 Hasson U ,  Avidan G ,  Gelbard H ,  Vallines I ,  Harel M ,  et al  ( 2009 )  Shared and idiosyncratic cortical activation patterns in autism revealed under continuous real-life viewing conditions .  Autism Research 
 2 :  220 – 231 .  doi:  10.1002/aur.89 
 19708061 9 Guo CC ,  Nguyen VT ,  Hyett MP ,  Parker GB ,  Breakspear MJ  ( 2015 )  Out-of-sync: disrupted neural activity in emotional circuitry during film viewing in melancholic depression .  Scientific reports 
 5 :  1 – 12 . 10 Nguyen VT ,  Sonkusare S ,  Stadler J ,  Hu X ,  Breakspear M ,  et al  ( 2016 )  Distinct Cerebellar Contributions to Cognitive-Perceptual Dynamics During Natural Viewing .  Cerebral Cortex . 11 Bordier C ,  Puja F ,  Macaluso E  ( 2013 )  Sensory processing during viewing of cinematographic material: Computational modeling and functional neuroimaging .  Neuroimage 
 67 :  213 – 226 .  doi:  10.1016/j.neuroimage.2012.11.031 
 23202431 12 Friston KJ ,  Holmes AP ,  Worsley KJ ,  Poline JP ,  Frith CD ,  et al  ( 1994 )  Statistical parametric maps in functional imaging: a general linear approach .  Human brain mapping 
 2 :  189 – 210 . 13 Naci L ,  Cusack R ,  Anello M ,  Owen AM  ( 2014 )  A common neural code for similar conscious experiences in different individuals .  Proceedings of the National Academy of Sciences 
 111 :  14277 – 14282 . 14 Bartels A ,  Zeki S  ( 2004 )  The chronoarchitecture of the human brain—natural viewing conditions reveal a time-based anatomy of the brain .  Neuroimage 
 22 :  419 – 433 .  doi:  10.1016/j.neuroimage.2004.01.007 
 15110035 15 Daubechies I ,  Roussos E ,  Takerkart S ,  Benharrosh M ,  Golden C ,  et al  ( 2009 )  Independent component analysis for brain fMRI does not select for independence .  Proceedings of the National Academy of Sciences 
 106 :  10415 – 10422 . 16 Quiroga RQ ,  Kreiman G ,  Koch C ,  Fried I  ( 2008 )  Sparse but not ‘grandmother-cell’coding in the medial temporal lobe .  Trends in cognitive sciences 
 12 :  87 – 91 .  doi:  10.1016/j.tics.2007.12.003 
 18262826 17 Lee K ,  Tak S ,  Ye JC  ( 2011 )  A data-driven sparse GLM for fMRI analysis using sparse dictionary learning with MDL criterion .  Medical Imaging, IEEE Transactions on 
 30 :  1076 – 1089 . 18 Lv J ,  Jiang X ,  Li X ,  Zhu D ,  Chen H ,  et al  ( 2015 )  Sparse representation of whole-brain FMRI signals for identification of functional networks .  Medical image analysis 
 20 :  112 – 134 .  25476415 19 Lv J ,  Jiang X ,  Li X ,  Zhu D ,  Zhang S ,  et al  ( 2015 )  Holistic Atlases of Functional Networks and Interactions Reveal Reciprocal Organizational Architecture of Cortical Function .  Biomedical Engineering, IEEE Transactions on 
 62 :  1120 – 1131 . 20 Xie J ,  Douglas PK ,  Wu YN ,  Brody AL ,  Anderson AE  ( 2017 )  Decoding the encoding of functional brain networks: An fMRI classification comparison of non-negative matrix factorization (NMF), independent component analysis (ICA), and sparse coding algorithms .  Journal of Neuroscience Methods 
 282 :  81 – 94 .  doi:  10.1016/j.jneumeth.2017.03.008 
 28322859 21 Nguyen HM. Dictionary learning based on sparse representations for resting-state functional MRI data analysis; 2017. IEEE. pp. 7–10. 22 Ren Y, Hu X, Lv J, Quo L, Han J, et al. Identifying autism biomarkers in default mode network using sparse representation of resting-state fMRI data; 2016. IEEE. pp. 1278–1281. 23 Lee Y-B ,  Lee J ,  Tak S ,  Lee K ,  Na DL ,  et al  ( 2016 )  Sparse SPM: Group Sparse-dictionary learning in SPM framework for resting-state functional connectivity MRI analysis .  Neuroimage 
 125 :  1032 – 1045 .  doi:  10.1016/j.neuroimage.2015.10.081 
 26524138 24 Lv J ,  Jiang X ,  Li X ,  Zhu D ,  Zhang S ,  et al  ( 2015 )  Holistic atlases of functional networks and interactions reveal reciprocal organizational architecture of cortical function .  IEEE Transactions on Biomedical Engineering 
 62 :  1120 – 1131 .  doi:  10.1109/TBME.2014.2369495 
 25420254 25 Mairal J ,  Bach F ,  Ponce J ,  Sapiro G  ( 2010 )  Online learning for matrix factorization and sparse coding .  Journal of Machine Learning Research 
 11 :  19 – 60 . 26 Lv J ,  Jiang X ,  Li X ,  Zhu D ,  Zhao S ,  et al  ( 2015 )  Assessing effects of prenatal alcohol exposure using group-wise sparse representation of fMRI data .  Psychiatry Research: Neuroimaging 
 233 :  254 – 268 .  doi:  10.1016/j.pscychresns.2015.07.012 
 26195294 27 Ren Y ,  Nguyen VT ,  Guo L ,  Guo CC  ( 2017 )  Inter-subject Functional Correlation Reveal a Hierarchical Organization of Extrinsic and Intrinsic Systems in the Brain .  Scientific Reports 
 7 :  10876 
 doi:  10.1038/s41598-017-11324-8 
 28883508 28 Hasson U ,  Malach R ,  Heeger DJ  ( 2010 )  Reliability of cortical activity during natural stimulation .  Trends in cognitive sciences 
 14 :  40 – 48 .  doi:  10.1016/j.tics.2009.10.011 
 20004608 29 Van Dijk KR ,  Sabuncu MR ,  Buckner RL  ( 2012 )  The influence of head motion on intrinsic functional connectivity MRI .  Neuroimage 
 59 :  431 – 438 .  doi:  10.1016/j.neuroimage.2011.07.044 
 21810475 30 Chen SS ,  Donoho DL ,  Saunders MA  ( 2001 )  Atomic decomposition by basis pursuit .  SIAM review 
 43 :  129 – 159 . 31 Lee H ,  Battle A ,  Raina R ,  Ng AY  ( 2007 )  Efficient sparse coding algorithms .  Advances in Neural Information Processing Systems 
 19 :  801 – 808 . 32 Tosic I ,  Frossard P  ( 2011 )  Dictionary learning .  IEEE Signal Processing Magazine 
 28 :  27 – 38 . 33 Poline J-B ,  Worsley KJ ,  Evans AC ,  Friston KJ  ( 1997 )  Combining spatial extent and peak intensity to test for activations in functional imaging .  Neuroimage 
 5 :  83 – 96 .  doi:  10.1006/nimg.1996.0248 
 9345540 34 Beckmann CF ,  Smith SM  ( 2005 )  Tensorial extensions of independent component analysis for multisubject FMRI analysis .  Neuroimage 
 25 :  294 – 311 .  doi:  10.1016/j.neuroimage.2004.10.043 
 15734364 35 Calhoun VD ,  Liu J ,  Adalı T  ( 2009 )  A review of group ICA for fMRI data and ICA for joint inference of imaging, genetic, and ERP data .  Neuroimage 
 45 :  S163 – S172 .  doi:  10.1016/j.neuroimage.2008.10.057 
 19059344 36 Svensén M ,  Kruggel F ,  Benali H  ( 2002 )  ICA of fMRI group study data .  NeuroImage 
 16 :  551 – 563 .  12169242 37 Hyvarinen A  ( 1999 )  Fast and robust fixed-point algorithms for independent component analysis .  IEEE transactions on Neural Networks 
 10 :  626 – 634 .  doi:  10.1109/72.761722 
 18252563 38 Hyvärinen A ,  Oja E  ( 2000 )  Independent component analysis: algorithms and applications .  Neural networks 
 13 :  411 – 430 .  10946390 39 Calhoun V ,  Adali T ,  Pearlson G ,  Pekar J  ( 2001 )  A method for making group inferences from functional MRI data using independent component analysis .  Human brain mapping 
 14 :  140 – 151 .  11559959 40 Smith SM ,  Fox PT ,  Miller KL ,  Glahn DC ,  Fox PM ,  et al  ( 2009 )  Correspondence of the brain’s functional architecture during activation and rest .  Proceedings of the National Academy of Sciences 
 106 :  13040 – 13045 . 41 McGraw KO ,  Wong SP  ( 1996 )  Forming inferences about some intraclass correlation coefficients .  Psychological methods 
 1 :  390 . 42 Shrout PE ,  Fleiss JL  ( 1979 )  Intraclass correlations: uses in assessing rater reliability .  Psychological bulletin 
 86 :  420 
 18839484 43 Guo CC ,  Kurth F ,  Zhou J ,  Mayer EA ,  Eickhoff SB ,  et al  ( 2012 )  One-year test–retest reliability of intrinsic connectivity network fMRI in older adults .  Neuroimage 
 61 :  1471 – 1483 .  doi:  10.1016/j.neuroimage.2012.03.027 
 22446491 44 Braun U ,  Plichta MM ,  Esslinger C ,  Sauer C ,  Haddad L ,  et al  ( 2012 )  Test–retest reliability of resting-state connectivity network characteristics using fMRI and graph theoretical measures .  Neuroimage 
 59 :  1404 – 1412 .  doi:  10.1016/j.neuroimage.2011.08.044 
 21888983 45 Griffanti L ,  Salimi-Khorshidi G ,  Beckmann CF ,  Auerbach EJ ,  Douaud G ,  et al  ( 2014 )  ICA-based artefact removal and accelerated fMRI acquisition for improved resting state network imaging .  Neuroimage 
 95 :  232 – 247 .  doi:  10.1016/j.neuroimage.2014.03.034 
 24657355 46 Salimi-Khorshidi G ,  Douaud G ,  Beckmann CF ,  Glasser MF ,  Griffanti L ,  et al  ( 2014 )  Automatic denoising of functional MRI data: combining independent component analysis and hierarchical fusion of classifiers .  Neuroimage 
 90 :  449 – 468 .  doi:  10.1016/j.neuroimage.2013.11.046 
 24389422 47 Bianchin M ,  Angrilli A  ( 2012 )  Gender differences in emotional responses: A psychophysiological study .  Physiology & behavior 
 105 :  925 – 932 . 22108508 48 Fugate JM ,  Gouzoules H ,  Barrett LF  ( 2009 )  Separating production from perception: Perceiver-based explanations for sex differences in emotion .  Behavioral and Brain Sciences 
 32 :  394 – 395 . 49 Andrews-Hanna JR ,  Snyder AZ ,  Vincent JL ,  Lustig C ,  Head D ,  et al  ( 2007 )  Disruption of large-scale brain systems in advanced aging .  Neuron 
 56 :  924 – 935 .  doi:  10.1016/j.neuron.2007.10.038 
 18054866 50 Friston K ,  Frith C ,  Liddle P ,  Frackowiak R  ( 1993 )  Functional connectivity: the principal-component analysis of large (PET) data sets .  Journal of Cerebral Blood Flow & Metabolism 
 13 :  5 – 14 . 8417010 51 Worsley KJ ,  Chen J-I ,  Lerch J ,  Evans AC  ( 2005 )  Comparing functional connectivity via thresholding correlations and singular value decomposition .  Philosophical Transactions of the Royal Society of London B: Biological Sciences 
 360 :  913 – 920 .  doi:  10.1098/rstb.2005.1637 
 16087436 52 Fedorenko E ,  Duncan J ,  Kanwisher N  ( 2013 )  Broad domain generality in focal regions of frontal and parietal cortex .  Proceedings of the National Academy of Sciences 
 110 :  16616 – 16621 . 53 Duncan J  ( 2010 )  The multiple-demand (MD) system of the primate brain: mental programs for intelligent behaviour .  Trends in cognitive sciences 
 14 :  172 – 179 .  doi:  10.1016/j.tics.2010.01.004 
 20171926 54 Pessoa L  ( 2012 )  Beyond brain regions: Network perspective of cognition–emotion interactions .  Behavioral and Brain Sciences 
 35 :  158 – 159 .  doi:  10.1017/S0140525X11001567 
 22617666 55 Kanwisher N  ( 2010 )  Functional specificity in the human brain: a window into the functional architecture of the mind .  Proceedings of the National Academy of Sciences 
 107 :  11163 – 11170 . 56 Anderson ML ,  Kinnison J ,  Pessoa L  ( 2013 )  Describing functional diversity of brain regions and brain networks .  Neuroimage 
 73 :  50 – 58 .  doi:  10.1016/j.neuroimage.2013.01.071 
 23396162 57 Gazzaniga MS  ( 2004 )  The cognitive neurosciences :  MIT press . 58 Yang H ,  Zhou Z ,  Liu Y ,  Ruan Z ,  Gong H ,  et al  ( 2007 )  Gender difference in hemodynamic responses of prefrontal area to emotional stress by near-infrared spectroscopy .  Behavioural brain research 
 178 :  172 – 176 .  doi:  10.1016/j.bbr.2006.11.039 
 17222468 59 Morita Y ,  Morita K ,  Yamamoto M ,  Waseda Y ,  Maeda H  ( 2001 )  Effects of facial affect recognition on the auditory P300 in healthy subjects .  Neuroscience Research 
 41 :  89 – 95 .  11535298 60 George MS ,  Ketter TA ,  Parekh PI ,  Herscovitch P ,  Post RM  ( 1996 )  Gender differences in regional cerebral blood flow during transient self-induced sadness or happiness .  Biological psychiatry 
 40 :  859 – 871 .  doi:  10.1016/0006-3223(95)00572-2 
 8896772 61 Kemp AH ,  Silberstein RB ,  Armstrong SM ,  Nathan PJ  ( 2004 )  Gender differences in the cortical electrophysiological processing of visual emotional stimuli .  NeuroImage 
 21 :  632 – 646 .  doi:  10.1016/j.neuroimage.2003.09.055 
 14980566 62 Wrase J ,  Klein S ,  Gruesser SM ,  Hermann D ,  Flor H ,  et al  ( 2003 )  Gender differences in the processing of standardized emotional visual stimuli in humans: a functional magnetic resonance imaging study .  Neuroscience letters 
 348 :  41 – 45 .  12893421 63 Decety J ,  Jackson PL  ( 2004 )  The functional architecture of human empathy .  Behavioral and cognitive neuroscience reviews 
 3 :  71 – 100 .  doi:  10.1177/1534582304267187 
 15537986 64 Craig AD  ( 2009 )  How do you feel—now? the anterior insula and human awareness .  Nature reviews neuroscience 
 10 :  59 – 70 .  doi:  10.1038/nrn2555 
 19096369 65 Nguyen VT ,  Breakspear M ,  Hu X ,  Guo CC  ( 2015 )  Hierarchical integration of interoception and exteroception in the anterior insula during naturalistic emotional experience. Autonomic Neuroscience :  Basic and Clinical 
 192 :  81 . 66 Nielsen FÅ ,  Balslev D ,  Hansen LK  ( 2005 )  Mining the posterior cingulate: segregation between memory and pain components .  NeuroImage 
 27 :  520 – 532 .  doi:  10.1016/j.neuroimage.2005.04.034 
 15946864 67 Lou HC ,  Luber B ,  Crupain M ,  Keenan JP ,  Nowak M ,  et al  ( 2004 )  Parietal cortex and representation of the mental self .  Proceedings of the National Academy of Sciences of the United States of America 
 101 :  6827 – 6832 .  doi:  10.1073/pnas.0400049101 
 15096584 68 Bigler ED ,  Mortensen S ,  Neeley ES ,  Ozonoff S ,  Krasny L ,  et al  ( 2007 )  Superior temporal gyrus, language function, and autism .  Developmental neuropsychology 
 31 :  217 – 238 .  doi:  10.1080/87565640701190841 
 17488217 69 Fox MD ,  Snyder AZ ,  Vincent JL ,  Corbetta M ,  Van Essen DC ,  et al  ( 2005 )  The human brain is intrinsically organized into dynamic, anticorrelated functional networks .  Proceedings of the National Academy of Sciences of the United States of America 
 102 :  9673 – 9678 .  doi:  10.1073/pnas.0504136102 
 15976020 70 Seeley WW ,  Menon V ,  Schatzberg AF ,  Keller J ,  Glover GH ,  et al  ( 2007 )  Dissociable intrinsic connectivity networks for salience processing and executive control .  The Journal of neuroscience 
 27 :  2349 – 2356 .  doi:  10.1523/JNEUROSCI.5587-06.2007 
 17329432 71 Buckner RL ,  Andrews-Hanna JR ,  Schacter DL  ( 2008 )  The brain’s default network .  Annals of the New York Academy of Sciences 
 1124 :  1 – 38 . 18400922 72 Wang J ,  Ren Y ,  Hu X ,  Nguyen VT ,  Guo L ,  et al  ( 2017 )  Test–retest reliability of functional connectivity networks during naturalistic fMRI paradigms .  Human brain mapping 
 38 :  2226 – 2241 .  doi:  10.1002/hbm.23517 
 28094464 73 Olshausen BA ,  Field DJ  ( 1997 )  Sparse coding with an overcomplete basis set: A strategy employed by V1? 
 Vision research 
 37 :  3311 – 3325 .  9425546 74 Lewicki MS ,  Sejnowski TJ  ( 2000 )  Learning overcomplete representations .  Neural computation 
 12 :  337 – 365 .  10636946 75 Aharon M ,  Elad M ,  Bruckstein A  ( 2006 )  K-SVD: An algorithm for designing overcomplete dictionaries for sparse representation .  IEEE transactions on signal processing 
 54 :  4311 – 4322 .